{"version":3,"file":"ec7c71150046c8fdd5f0.js","mappings":"wNA6FMA,EAAqB,IA1FF,WACrB,SAAAC,KAAcC,EAAAA,EAAAA,GAAA,KAAAD,GACVE,KAAKC,OAAS,CAAC,EACfD,KAAKE,mBAAqB,KAC1BF,KAAKG,gBAAkB,KACvBH,KAAKI,WAAa,KAClBJ,KAAKK,WAAa,CACtB,CA+EC,OA/EAC,EAAAA,EAAAA,GAAAR,EAAA,EAAAS,IAAA,2BAAAC,MAED,WAA2B,IAAAC,EAAA,KACvB,GAAIT,KAAKC,OAAuB,eAAG,CAE/B,IAAIS,EAAe,WACfD,EAAKE,sBACT,EAEIX,KAAKC,OAAoB,cACzBW,EAAAA,EAAiBC,OAAOC,OAAQ,YAAaJ,EAAc,mBAC3DE,EAAAA,EAAiBC,OAAOE,SAAU,YAAaL,EAAc,oBAGjEE,EAAAA,EAAiBC,OAAOC,OAAQ,YAAaJ,EAAc,iBAC3DE,EAAAA,EAAiBC,OAAOC,OAAQ,QAASJ,EAAc,aACvDE,EAAAA,EAAiBC,OAAOC,OAAQ,SAAUJ,EAAc,cACxDE,EAAAA,EAAiBC,OAAOC,OAAQ,WAAYJ,EAAc,gBAC1DE,EAAAA,EAAiBC,OAAOC,OAAQ,OAAQJ,EAAc,YACtDE,EAAAA,EAAiBC,OAAOE,SAAU,SAAUL,EAAc,cAC1DE,EAAAA,EAAiBC,OAAOE,SAAU,aAAcL,EAAc,kBAC9DE,EAAAA,EAAiBC,OAAOE,SAAU,WAAYL,EAAc,gBAE5DV,KAAKW,sBACT,CACJ,GAAC,CAAAJ,IAAA,uBAAAC,MAED,WAAuB,IAAAQ,EAAA,KACfC,EAAiC,GAAnBjB,KAAKK,WAEvBL,KAAKK,WAAa,EAEC,GAAfY,GACAjB,KAAKkB,eAAe,GAGxBC,aAAanB,KAAKG,iBAElBH,KAAKG,gBAAkBiB,YAAW,WAC9BJ,EAAKX,WAAa,EAClBW,EAAKE,eAAe,EACxB,GAAG,IACP,GAAC,CAAAX,IAAA,YAAAC,MAED,SAAUP,EAAQG,GACdJ,KAAKC,OAASA,EACdD,KAAKI,WAAaA,EAClBJ,KAAKqB,2BACLrB,KAAKsB,gBACT,GAAC,CAAAf,IAAA,iBAAAC,MAED,WAAiB,IAAAe,EAAA,KACbJ,aAAanB,KAAKE,oBAClBF,KAAKE,mBAAqBkB,YAAW,WACjCG,EAAKL,eAAe,GACpBK,EAAKD,gBACT,GAA4B,IAAzBtB,KAAKC,OAAgB,QAC5B,GAAC,CAAAM,IAAA,iBAAAC,MAED,SAAegB,GAAQ,IAAAC,EAAA,KACbC,EAAa1B,KAAKI,WAAwB,YAAEuB,uBAE9C1B,EAAS,CACT,IAAOD,KAAKI,WAAWwB,YAAYC,SACnC,MAAU7B,KAAKI,WAAW0B,aAAatB,MAAQ,EAAI,EACnD,QAAWgB,EACX,OAAUxB,KAAKK,WACf,IAAOL,KAAKI,WAAW2B,WAAWC,KAAK,MAGvCN,EAAe,IAAKA,EAAiB,OACrCzB,EAAa,KAAIyB,EAAe,GAAI,IAAMA,EAAiB,MAG/DO,EAAAA,EAAgBC,YAAYlC,KAAKI,WAAW+B,QAAQC,KAAKC,aAAerC,KAAKI,WAAiB,KAAI,gCAAiC,CAACH,OAAQA,IAAS,SAACqC,GACxH,GAAtBA,EAAKC,eAAyBd,EAAKrB,WAAWoC,aAAahC,OAAS8B,EAAKG,QACzEhB,EAAKrB,WAAWoC,aAAaE,KAAKJ,EAAKG,OAE/C,GACJ,KAAC3C,CAAA,CAtFoB,G","sources":["webpack://LiveHelperChat/./src/util/activityMonitoring.js"],"sourcesContent":["import {domEventsHandler} from '../util/domEventsHandler';\nimport {helperFunctions} from '../lib/helperFunctions';\n\nclass _activityMonitoring {\n    constructor() {\n        this.params = {};\n        this.timeoutStatuscheck = null;\n        this.timeoutActivity = null;\n        this.attributes = null;\n        this.userActive = 1;\n    }\n\n    attatchActivityListeners() {\n        if (this.params['track_activity']) {\n\n            var resetTimeout = () => {\n                this.resetTimeoutActivity();\n            };\n\n            if (this.params['track_mouse']) {\n                domEventsHandler.listen(window, 'mousemove', resetTimeout, 'lhc_mousemove_w');\n                domEventsHandler.listen(document, 'mousemove', resetTimeout, 'lhc_mousemove_d');\n            }\n\n            domEventsHandler.listen(window, 'mousedown', resetTimeout, 'lhc_mousedown');\n            domEventsHandler.listen(window, 'click', resetTimeout, 'lhc_click');\n            domEventsHandler.listen(window, 'scroll', resetTimeout, 'lhc_scroll');\n            domEventsHandler.listen(window, 'keypress', resetTimeout, 'lhc_keypress');\n            domEventsHandler.listen(window, 'load', resetTimeout, 'lhc_load');\n            domEventsHandler.listen(document, 'scroll', resetTimeout, 'lhc_scroll');\n            domEventsHandler.listen(document, 'touchstart', resetTimeout, 'lhc_touchstart');\n            domEventsHandler.listen(document, 'touchend', resetTimeout, 'lhc_touchend');\n\n            this.resetTimeoutActivity();\n        }\n    }\n\n    resetTimeoutActivity() {\n        var wasInactive = this.userActive == 0;\n\n        this.userActive = 1;\n\n        if (wasInactive == true) {\n            this.syncUserStatus(1);\n        }\n\n        clearTimeout(this.timeoutActivity);\n\n        this.timeoutActivity = setTimeout(() => {\n            this.userActive = 0;\n            this.syncUserStatus(1);\n        }, 300 * 1000);\n    }\n\n    setParams(params, attributes) {\n        this.params = params;\n        this.attributes = attributes;\n        this.attatchActivityListeners();\n        this.initMonitoring();\n    }\n\n    initMonitoring() {\n        clearTimeout(this.timeoutStatuscheck);\n        this.timeoutStatuscheck = setTimeout(() => {\n            this.syncUserStatus(0);\n            this.initMonitoring();\n        }, this.params['timeout'] * 1000);\n    }\n\n    syncUserStatus(sender) {\n        const chatParams = this.attributes['userSession'].getSessionAttributes();\n\n        let params = {\n            'vid': this.attributes.userSession.getVID(),\n            'wopen': (this.attributes.widgetStatus.value ? 1 : 0),\n            'uaction': sender,\n            'uactiv': this.userActive,\n            'dep': this.attributes.department.join(',')\n        };\n\n        if (chatParams['id'] && chatParams['hash']) {\n            params['hash'] = chatParams['id'] + '_' + chatParams['hash'];\n        }\n\n        helperFunctions.makeRequest(this.attributes.LHC_API.args.lhc_base_url + this.attributes['lang'] + 'widgetrestapi/chatcheckstatus', {params: params}, (data) => {\n            if (data.change_status == true && this.attributes.onlineStatus.value != data.online) {\n                this.attributes.onlineStatus.next(data.online);\n            }\n        });\n    }\n\n}\n\nconst activityMonitoring = new _activityMonitoring();\nexport {activityMonitoring};"],"names":["activityMonitoring","_activityMonitoring","_classCallCheck","this","params","timeoutStatuscheck","timeoutActivity","attributes","userActive","_createClass","key","value","_this","resetTimeout","resetTimeoutActivity","domEventsHandler","listen","window","document","_this2","wasInactive","syncUserStatus","clearTimeout","setTimeout","attatchActivityListeners","initMonitoring","_this3","sender","_this4","chatParams","getSessionAttributes","userSession","getVID","widgetStatus","department","join","helperFunctions","makeRequest","LHC_API","args","lhc_base_url","data","change_status","onlineStatus","online","next"],"sourceRoot":""}